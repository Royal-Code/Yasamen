@using RoyalCode.Yasamen.Demos.Wasm.BlazorShow.Components.Contexts;
@using System.Diagnostics.CodeAnalysis;

<CascadingValue Value="context">
    <div class="scene-show">
        <h3>@Scene.Show.Name - @Scene.Name</h3>
        <div class="scene-component">
            @if (Scene.RenderKind == ShowRenderKind.Direct)
            {
                <SceneRender />
            }
            else
            {
                <SceneFrame />
            }
        </div>
        <div class="scene-properties">
            The properties of the component.

            @foreach (var property in Scene.SceneProperties.Where(p => !p.IsHidden))
            {
                <SceneProperty Property="property" @key=@property.Name />
            }

        </div>
    </div>
</CascadingValue>

@code {
    private SceneContext? context;

    [Parameter, EditorRequired]
    public IScene Scene { get; set; }

    [MemberNotNull(nameof(context), nameof(Scene))]
    protected override void OnParametersSet()
    {
        context = new SceneContext(Scene);
    }
}
